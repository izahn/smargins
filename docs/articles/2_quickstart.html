<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>smargins Quickstart Guide • smargins</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">smargins</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_about.html">About smargins</a>
    </li>
    <li>
      <a href="../articles/2_quickstart.html">smargins Quickstart Guide</a>
    </li>
    <li>
      <a href="../articles/3_lm.html">AMEs for LMs</a>
    </li>
    <li>
      <a href="../articles/4_glm.html">AMEs for GLMs</a>
    </li>
    <li>
      <a href="../articles/5_svyglm.html">AMEs for Regression with Survey Weights</a>
    </li>
    <li>
      <a href="../articles/6_tobit.html">AMEs for Tobit Models</a>
    </li>
    <li>
      <a href="../articles/7_transforming_covariates.html">Transforming Covariates</a>
    </li>
    <li>
      <a href="../articles/8_with_Amelia.html">Using smargins with Amelia</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>smargins Quickstart Guide</h1>
            
            <h4 class="date">2017-11-14</h4>
          </div>

    
    
<div class="contents">
<section id="workflow-overview" class="level2"><h2>Workflow overview</h2>
<p>Models in R can generally be fit using a formula interface. The fitted models can then be explored and post-processed in various was, for example to display an ANOVA-style table, calculate confidence intervals, or plot predictions from the model. This package provides additional post-estimation functions to calculate average marginal effects along with simulation-based estimates of uncertainty.</p>
</section><section id="examples" class="level1"><h1>Examples</h1>
<p>Let’s walk through an example. This example uses the Prestige dataset. It contains data on 102 occupations. We will model the effect of education and type on income.</p>
<section id="building-models" class="level2"><h2>Building Models</h2>
<p>Since income is a continuous variable, least squares is an appropriate model choice. To estimate our model, we call the <code>lm</code> function:</p>
<pre class="sourceCode r" id="cb1"><code class="sourceCode r"><div class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># load data</span></div>
<div class="sourceLine" id="cb1-2" data-line-number="2">
<span class="kw">options</span>(<span class="dt">StringsAsFactors =</span> <span class="ot">FALSE</span>)</div>
<div class="sourceLine" id="cb1-3" data-line-number="3">
<span class="kw">data</span>(Prestige, <span class="dt">package =</span> <span class="st">"car"</span>)</div>
<div class="sourceLine" id="cb1-4" data-line-number="4"></div>
<div class="sourceLine" id="cb1-5" data-line-number="5">Prestige &lt;-<span class="st"> </span><span class="kw">na.omit</span>(Prestige)</div>
<div class="sourceLine" id="cb1-6" data-line-number="6"></div>
<div class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># estimate ls model</span></div>
<div class="sourceLine" id="cb1-8" data-line-number="8">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(income <span class="op">~</span><span class="st"> </span>education <span class="op">+</span><span class="st"> </span>type, <span class="dt">data =</span> Prestige)</div>
<div class="sourceLine" id="cb1-9" data-line-number="9"></div>
<div class="sourceLine" id="cb1-10" data-line-number="10"><span class="co"># model summary</span></div>
<div class="sourceLine" id="cb1-11" data-line-number="11">
<span class="kw">summary</span>(m1)</div></code></pre>
<pre><code>## 
## Call:
## lm(formula = income ~ education + type, data = Prestige)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6242.7 -1768.0  -408.3  1149.1 16939.3 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  -2048.2     2431.5  -0.842  0.40171   
## education      887.9      284.7   3.119  0.00241 **
## typeprof       102.1     1805.3   0.057  0.95501   
## typewc       -2685.8     1140.5  -2.355  0.02061 * 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3312 on 94 degrees of freedom
## Multiple R-squared:  0.4052, Adjusted R-squared:  0.3862 
## F-statistic: 21.35 on 3 and 94 DF,  p-value: 1.249e-10</code></pre>
<p>Since this is an ordinary least squares regression, the coefficients are themselves quantities of interest. The <code>education</code> coefficient tells us that (holding occupation type constant) every additional year of education is associated with an $887.9 increase in income. The coefficients for <code>typeprof</code> and <code>typewc</code> are slightly more difficult to interpret. They are dummy codes that tell us the expected difference between blue-collar and professional incomes, and between blue-collar and white-collar incomes.</p>
<p>Although the model coefficients are not difficult to interpret, the average marginal effects are even more straight-forward. We can calculate theme using the <code>smargins</code> function.</p>
<pre class="sourceCode r" id="cb3"><code class="sourceCode r"><div class="sourceLine" id="cb3-1" data-line-number="1">
<span class="kw">library</span>(smargins)</div>
<div class="sourceLine" id="cb3-2" data-line-number="2"></div>
<div class="sourceLine" id="cb3-3" data-line-number="3">ppred1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/smargins.html">smargins</a></span>(m1, <span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">type =</span> <span class="kw">unique</span>(Prestige<span class="op">$</span>type)))</div>
<div class="sourceLine" id="cb3-4" data-line-number="4"></div>
<div class="sourceLine" id="cb3-5" data-line-number="5">ppred1</div></code></pre>
<pre><code>##      type .sim_number .smargin_qi
## 1    prof           1    6403.065
## 2    prof           2    8480.511
## 3    prof           3    7493.514
## 4    prof           4    5115.365
## 5    prof           5    6222.472
## 6    prof           6    8259.206
## # - - - - - - - - - - - - - - - -                                 
## 2995   wc         995    6626.907
## 2996   wc         996    4264.392
## 2997   wc         997    5733.285
## 2998   wc         998    4746.942
## 2999   wc         999    4768.615
## 3000   wc        1000    5213.085</code></pre>
<p>The print method shows us how the result is organized. There is a summary method that gives a default set of statistics for each combination of values specified in the <code>at</code> argument:</p>
<pre class="sourceCode r" id="cb5"><code class="sourceCode r"><div class="sourceLine" id="cb5-1" data-line-number="1">
<span class="kw">summary</span>(ppred1)</div></code></pre>
<pre><code>##   type     mean        sd   median lower_2.5 upper_97.5
## 1 prof 7641.524 1132.4734 7618.644  5441.452   9843.880
## 2   bc 7528.110  860.2856 7538.573  5758.365   9164.554
## 3   wc 4876.804  675.1763 4856.793  3604.888   6281.376</code></pre>
</section><section id="comparisons" class="level2"><h2>Comparisons</h2>
<p>The summary method shows expected values for each value specified in the <code>at</code> argument, but frequently we want some transformation of these values. There is a <code>scompare</code> function that gives pairwise differences:</p>
<pre class="sourceCode r" id="cb7"><code class="sourceCode r"><div class="sourceLine" id="cb7-1" data-line-number="1">
<span class="kw">summary</span>(<span class="kw"><a href="../reference/scompare.html">scompare</a></span>(ppred1, <span class="st">"type"</span>))</div></code></pre>
<pre><code>##         type      mean       sd    median  lower_2.5 upper_97.5
## 1 prof vs bc 2764.7197 1241.605 2795.4306   301.2291   5080.718
## 2 prof vs wc -113.4141 1833.291 -121.9363 -3747.7612   3594.661
## 3   bc vs wc 2651.3056 1136.463 2672.7300   222.8833   4838.018</code></pre>
<p>but the really great thing is that the structure is simple enough that the user can perform their own arbitrary transformations. For example, we can compare the average of white collar and professional with blue collar:</p>
<pre class="sourceCode r" id="cb9"><code class="sourceCode r"><div class="sourceLine" id="cb9-1" data-line-number="1">bc &lt;-<span class="st"> </span><span class="kw">subset</span>(ppred1, type <span class="op">==</span><span class="st"> "bc"</span>)<span class="op">$</span>.smargin_qi</div>
<div class="sourceLine" id="cb9-2" data-line-number="2">wc_prof &lt;-<span class="st"> </span><span class="kw">subset</span>(ppred1, type <span class="op">==</span><span class="st"> "wc"</span>)<span class="op">$</span>.smargin_qi <span class="op">+</span>
</div>
<div class="sourceLine" id="cb9-3" data-line-number="3">
<span class="st">           </span><span class="kw">subset</span>(ppred1, type <span class="op">==</span><span class="st"> "wc"</span>)<span class="op">$</span>.smargin_qi</div>
<div class="sourceLine" id="cb9-4" data-line-number="4">
<span class="kw"><a href="../reference/sumstats.html">sumstats</a></span>(bc <span class="op">-</span><span class="st"> </span>wc_prof)</div></code></pre>
<pre><code>##       mean         sd     median  lower_2.5 upper_97.5 
## -2112.0848  1647.5605 -2076.3729 -5413.5168   964.9362</code></pre>
</section><section id="visualizations" class="level2"><h2>Visualizations</h2>
<p>Another advantage of the simple data structure returned by <code>smargins</code> is that it makes creating plots using standard graphics packages in R easy. For example, we can graph the expected values by type:</p>
<pre class="sourceCode r" id="cb11"><code class="sourceCode r"><div class="sourceLine" id="cb11-1" data-line-number="1">
<span class="kw">library</span>(ggplot2)</div>
<div class="sourceLine" id="cb11-2" data-line-number="2"></div>
<div class="sourceLine" id="cb11-3" data-line-number="3">
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw">summary</span>(ppred1),</div>
<div class="sourceLine" id="cb11-4" data-line-number="4">       <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> mean, <span class="dt">y =</span> type)) <span class="op">+</span>
</div>
<div class="sourceLine" id="cb11-5" data-line-number="5">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span>
</div>
<div class="sourceLine" id="cb11-6" data-line-number="6">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_errorbarh">geom_errorbarh</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">xmin =</span> lower_<span class="fl">2.5</span>, <span class="dt">xmax =</span> upper_<span class="fl">97.5</span>),</div>
<div class="sourceLine" id="cb11-7" data-line-number="7">                   <span class="dt">height =</span> <span class="fl">0.25</span>)</div></code></pre>
<p><img src="2_quickstart_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<pre class="sourceCode r" id="cb12"><code class="sourceCode r"><div class="sourceLine" id="cb12-1" data-line-number="1">
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(ppred1,</div>
<div class="sourceLine" id="cb12-2" data-line-number="2">       <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> .smargin_qi)) <span class="op">+</span>
</div>
<div class="sourceLine" id="cb12-3" data-line-number="3">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">fill =</span> type), <span class="dt">alpha =</span> <span class="fl">0.25</span>)</div></code></pre>
<p><img src="2_quickstart_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>This is especially useful for plotting interactions:</p>
<pre class="sourceCode r" id="cb13"><code class="sourceCode r"><div class="sourceLine" id="cb13-1" data-line-number="1">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(income <span class="op">~</span><span class="st"> </span>education<span class="op">*</span>type, <span class="dt">data =</span> Prestige)</div>
<div class="sourceLine" id="cb13-2" data-line-number="2"></div>
<div class="sourceLine" id="cb13-3" data-line-number="3">m2.sm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/smargins.html">smargins</a></span>(m2, <span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">education =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">16</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">"bc"</span>, <span class="st">"prof"</span>, <span class="st">"wc"</span>)))</div>
<div class="sourceLine" id="cb13-4" data-line-number="4"></div>
<div class="sourceLine" id="cb13-5" data-line-number="5">
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw">summary</span>(m2.sm),</div>
<div class="sourceLine" id="cb13-6" data-line-number="6">       <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> education, <span class="dt">y =</span> mean, <span class="dt">color =</span> type)) <span class="op">+</span>
</div>
<div class="sourceLine" id="cb13-7" data-line-number="7">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_smooth">geom_smooth</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">ymin =</span> lower_<span class="fl">2.5</span>, <span class="dt">ymax =</span> upper_<span class="fl">97.5</span>),</div>
<div class="sourceLine" id="cb13-8" data-line-number="8">                <span class="dt">stat =</span> <span class="st">"identity"</span>,</div>
<div class="sourceLine" id="cb13-9" data-line-number="9">                <span class="dt">alpha =</span> <span class="fl">0.25</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>type)</div></code></pre>
<pre><code>## Warning: Ignoring unknown aesthetics: ymin, ymax</code></pre>
<p><img src="2_quickstart_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</section></section>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#workflow-overview">Workflow overview</a></li>
      <li>
<a href="#examples">Examples</a><ul class="nav nav-pills nav-stacked">
<li><a href="#building-models">Building Models</a></li>
      <li><a href="#comparisons">Comparisons</a></li>
      <li><a href="#visualizations">Visualizations</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ista Zahn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
